AWSTemplateFormatVersion: '2010-09-09'
Description: A stack for deploying containerized applications in AWS Fargate.
             This stack runs containers in a public or private VPC subnet. 

Mappings:
  # The VPC and subnet configuration is passed in via the environment spec.
  SubnetConfig:
    VPC:
      CIDR: '{{ environment.inputs.vpc_cidr}}'
    PublicOne:
      CIDR: '{{ environment.inputs.subnet_one_cidr}}'
    PublicTwo:
      CIDR: '{{ environment.inputs.subnet_two_cidr}}'
  
Resources:
  Cluster:
    Type: 'AWS::ECS::Cluster'
  ServiceTaskDefExecutionRole:
    Type: 'AWS::IAM::Role'
    Properties:
      AssumeRolePolicyDocument:
        Statement:
          - Action: 'sts:AssumeRole'
            Effect: Allow
            Principal:
              Service: ecs-tasks.amazonaws.com
        Version: 2012-10-17
      ManagedPolicyArns:
        - 'arn:aws:iam::aws:policy/service-role/AmazonECSTaskExecutionRolePolicy'
# Outputs:
  # Cluster:
    # Description: The name of the ECS cluster
    # Value: !Ref 'Cluster'
  # ClusterArn:
    # Description: The ARN of the ECS cluster
    # Value: !GetAtt 'Cluster.Arn'
  # ServiceTaskDefExecutionRoleArn:
    # Description: The ARN of the ECS role
    # Value: !GetAtt 'ServiceTaskDefExecutionRole.Arn'
  # CloudMapNamespaceId:
    # Description: CloudMap namespace Id
    # Value: !GetAtt 'CloudMapNamespace.Id'
